<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareerMate - Recruiter Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="api-client.js"></script>
    <script src="auth-helper.js"></script>
    <script src="nhatuyendung-integration.js"></script>
    <script src="chat-ai.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .kanban-column { min-width: 280px; }
        @media (max-width: 768px) {
            .kanban-column { min-width: 250px; }
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .mobile-tabs {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .mobile-tabs.active {
            max-height: 500px;
        }
        /* Chat Box Styles */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        .chat-button i {
            color: white;
            font-size: 24px;
        }
        .chat-window {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 380px;
            max-width: calc(100vw - 40px);
            height: 600px;
            max-height: calc(100vh - 120px);
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
            z-index: 1001;
        }
        .chat-window.active {
            display: flex;
        }
        .chat-header {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .chat-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .chat-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
            padding: 4px;
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .message {
            display: flex;
            gap: 8px;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .message.user {
            flex-direction: row-reverse;
        }
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .message.ai .message-avatar {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        .message.user .message-avatar {
            background: #e5e7eb;
            color: #6b7280;
        }
        .message-content {
            max-width: 75%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
        }
        .message.ai .message-content {
            background: #f3f4f6;
            color: #1f2937;
        }
        .message.user .message-content {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        .chat-input-area {
            padding: 16px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 8px;
        }
        .chat-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
        }
        .chat-input:focus {
            border-color: #3b82f6;
        }
        .chat-upload {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #3b82f6;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .chat-upload:hover {
            background: #e5e7eb;
            border-color: #3b82f6;
        }
        .chat-send {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .chat-send:hover {
            opacity: 0.9;
        }
        .file-input-hidden {
            display: none;
        }
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 10px 14px;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #9ca3af;
            animation: typing 1.4s infinite;
        }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
        }
        .quick-action-btn {
            padding: 6px 12px;
            background: #f3f4f6;
            border: none;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .quick-action-btn:hover {
            background: #e5e7eb;
        }
        @media (max-width: 640px) {
            .chat-window {
                width: calc(100vw - 20px);
                right: 10px;
                bottom: 80px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 h-screen flex flex-col">

    <nav class="bg-white border-b border-gray-200 h-14 sm:h-16 flex items-center justify-between px-4 sm:px-6 shrink-0">
        <div class="flex items-center gap-3 sm:gap-8">
            <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-600 hover:text-gray-900">
                <i class="fas fa-bars text-lg"></i>
            </button>
            <a href="nhatuyendung.html" class="text-xl sm:text-2xl font-bold text-blue-600 tracking-tight">CareerMate</a>
            <div class="hidden md:flex gap-4 lg:gap-6 text-sm font-medium text-gray-500">
                <a href="#dashboard" onclick="showTab('dashboard', event)" class="tab-link hover:text-blue-600 transition">Dashboard</a>
                <a href="#post-job" onclick="showTab('post-job', event)" class="tab-link hover:text-blue-600 transition">ƒêƒÉng tin</a>
                <a href="#applicants" onclick="showTab('applicants', event)" class="tab-link text-blue-600">·ª®ng vi√™n</a>
                <a href="#job-matching" onclick="showTab('job-matching', event)" class="tab-link hover:text-blue-600 transition">G·ª£i √Ω ·ª©ng vi√™n</a>
                <a href="#vip" onclick="showTab('vip', event)" class="tab-link hover:text-blue-600 transition">G√≥i VIP <span class="text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full ml-1">Gold</span></a>
            </div>
        </div>
        <div class="flex items-center gap-2 sm:gap-4">
            <button class="p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 relative">
                <i class="fas fa-bell text-lg sm:text-xl"></i>
                <span class="absolute top-0 right-0 h-2 w-2 bg-red-500 rounded-full"></span>
            </button>
            <div class="relative" id="userMenuContainer">
                <div id="userMenuBtn" class="h-7 w-7 sm:h-8 sm:w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold border border-blue-200 text-xs sm:text-sm cursor-pointer hover:bg-blue-200 transition">HR</div>
                <div id="userMenuDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 hidden z-50">
                    <a href="recruiter-profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition">
                        <i class="fas fa-user mr-2"></i>H·ªì s∆°
                    </a>
                    <a href="recruiter-company.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition">
                        <i class="fas fa-building mr-2"></i>C√¥ng ty
                    </a>
                    <a href="recruiter-settings.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition">
                        <i class="fas fa-cog mr-2"></i>C√†i ƒë·∫∑t
                    </a>
                    <hr class="my-2">
                    <a href="#" onclick="window.logout(); return false;" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition">
                        <i class="fas fa-sign-out-alt mr-2"></i>ƒêƒÉng xu·∫•t
                    </a>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-tabs md:hidden bg-white border-b border-gray-200">
        <div class="px-4 py-3 space-y-1">
            <a href="#dashboard" onclick="showTab('dashboard', event)" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded-lg text-sm">Dashboard</a>
            <a href="#post-job" onclick="showTab('post-job', event)" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded-lg text-sm">ƒêƒÉng tin</a>
            <a href="#applicants" onclick="showTab('applicants', event)" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded-lg text-sm">·ª®ng vi√™n</a>
            <a href="#job-matching" onclick="showTab('job-matching', event)" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded-lg text-sm">G·ª£i √Ω ·ª©ng vi√™n</a>
            <a href="#vip" onclick="showTab('vip', event)" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded-lg text-sm">G√≥i VIP <span class="text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full ml-1">Gold</span></a>
        </div>
    </div>

    <!-- Applicants Tab Content -->
    <div id="applicants" class="tab-content">
        <header class="bg-white border-b border-gray-200 px-4 sm:px-6 py-3 sm:py-4 flex flex-col md:flex-row md:items-center justify-between gap-3 sm:gap-4 shrink-0">
            <div class="flex-1 min-w-0">
                <div class="flex flex-wrap items-center gap-2 sm:gap-3">
                    <h1 id="currentJobTitle" class="text-lg sm:text-xl font-bold text-gray-900 break-words">Ch·ªçn tin tuy·ªÉn d·ª•ng</h1>
                    <span id="currentJobStatus" class="px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 whitespace-nowrap">-</span>
                </div>
                <p id="currentJobInfo" class="text-xs sm:text-sm text-gray-500 mt-1 break-words">Ch∆∞a ch·ªçn tin tuy·ªÉn d·ª•ng</p>
            </div>
            <div class="flex gap-2 sm:gap-3">
                <select id="jobSelector" onchange="if(this.value) viewJobApplicants(this.value)" class="px-3 sm:px-4 py-1.5 sm:py-2 border border-gray-300 rounded-lg text-xs sm:text-sm font-medium hover:bg-gray-50 text-gray-700">
                    <option value="">Ch·ªçn tin tuy·ªÉn d·ª•ng</option>
                </select>
                <button onclick="if(currentJobId) editJob(currentJobId)" class="px-3 sm:px-4 py-1.5 sm:py-2 bg-blue-600 rounded-lg text-xs sm:text-sm font-medium hover:bg-blue-700 text-white shadow-sm">
                    <span class="hidden sm:inline">S·ª≠a tin ƒëƒÉng</span>
                    <span class="sm:hidden">S·ª≠a</span>
                </button>
            </div>
        </header>

        <main class="flex-1 overflow-x-auto overflow-y-hidden p-3 sm:p-4 lg:p-6">
            <div class="flex h-full gap-3 sm:gap-4 lg:gap-6 min-w-max">
            
            <div class="kanban-column flex flex-col w-[280px] sm:w-80 bg-gray-100 rounded-lg sm:rounded-xl border border-gray-200 h-full">
                <div class="p-3 sm:p-4 flex items-center justify-between border-b border-gray-200/50">
                    <h3 class="font-semibold text-gray-700 text-sm sm:text-base">M·ªõi ·ª©ng tuy·ªÉn <span class="bg-gray-200 text-gray-600 text-xs px-1.5 sm:px-2 py-0.5 rounded-full ml-1 sm:ml-2">3</span></h3>
                    <button class="text-gray-400 hover:text-gray-600 text-xs sm:text-sm">‚Ä¢‚Ä¢‚Ä¢</button>
                </div>
                <div class="flex-1 overflow-y-auto p-2 sm:p-3 space-y-2 sm:space-y-3 custom-scrollbar">
                    
                    <!-- Applicants will be loaded dynamically -->

                </div>
            </div>

            <div class="kanban-column flex flex-col w-[280px] sm:w-80 bg-gray-100 rounded-lg sm:rounded-xl border border-gray-200 h-full">
                <div class="p-3 sm:p-4 flex items-center justify-between border-b border-gray-200/50">
                    <h3 class="font-semibold text-blue-700 text-sm sm:text-base">ƒê√£ xem <span class="bg-blue-100 text-blue-700 text-xs px-1.5 sm:px-2 py-0.5 rounded-full ml-1 sm:ml-2">2</span></h3>
                    <button class="text-gray-400 hover:text-gray-600 text-xs sm:text-sm">‚Ä¢‚Ä¢‚Ä¢</button>
                </div>
                <div class="flex-1 overflow-y-auto p-2 sm:p-3 space-y-2 sm:space-y-3">
                    
                    <!-- Applicants will be loaded dynamically -->

                </div>
            </div>

            <div class="kanban-column flex flex-col w-[280px] sm:w-80 bg-gray-100 rounded-lg sm:rounded-xl border border-gray-200 h-full">
                <div class="p-3 sm:p-4 flex items-center justify-between border-b border-gray-200/50">
                    <h3 class="font-semibold text-purple-700 text-sm sm:text-base">Ph·ªèng v·∫•n <span class="bg-purple-100 text-purple-700 text-xs px-1.5 sm:px-2 py-0.5 rounded-full ml-1 sm:ml-2">1</span></h3>
                    <button class="text-gray-400 hover:text-gray-600 text-xs sm:text-sm">‚Ä¢‚Ä¢‚Ä¢</button>
                </div>
                <div class="flex-1 overflow-y-auto p-2 sm:p-3 space-y-2 sm:space-y-3">
                    
                    <!-- Applicants will be loaded dynamically -->

                </div>
            </div>

            <div class="kanban-column flex flex-col w-[280px] sm:w-80 bg-gray-100 rounded-lg sm:rounded-xl border border-gray-200 h-full">
                <div class="p-3 sm:p-4 flex items-center justify-between border-b border-gray-200/50">
                    <h3 class="font-semibold text-green-700 text-sm sm:text-base">ƒê√£ Offer <span class="bg-green-100 text-green-700 text-xs px-1.5 sm:px-2 py-0.5 rounded-full ml-1 sm:ml-2">0</span></h3>
                    <button class="text-gray-400 hover:text-gray-600 text-xs sm:text-sm">‚Ä¢‚Ä¢‚Ä¢</button>
                </div>
                <div class="flex-1 overflow-y-auto p-2 sm:p-3 space-y-2 sm:space-y-3">
                    <!-- Applicants will be loaded dynamically -->
                </div>
            </div>

            </div>
        </main>
    </div>

    <!-- Post Job Tab Content -->
    <div id="post-job" class="tab-content">
        <main class="flex-1 overflow-y-auto p-4 sm:p-6">
            <div class="max-w-4xl mx-auto">
                <!-- Company Required Warning -->
                <div id="companyRequiredWarning" class="hidden bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-start">
                        <i class="fas fa-exclamation-triangle text-yellow-600 text-xl mr-3 mt-1"></i>
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-yellow-800 mb-1">Ch∆∞a c√≥ th√¥ng tin c√¥ng ty</h3>
                            <p class="text-sm text-yellow-700 mb-3">
                                B·∫°n c·∫ßn t·∫°o th√¥ng tin c√¥ng ty tr∆∞·ªõc khi ƒëƒÉng tin tuy·ªÉn d·ª•ng.
                            </p>
                            <a href="recruiter-company.html" class="inline-block px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition text-sm font-medium">
                                <i class="fas fa-building mr-2"></i>T·∫°o th√¥ng tin c√¥ng ty ngay
                            </a>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6 lg:p-8 mb-4 sm:mb-6">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">ƒêƒÉng tin tuy·ªÉn d·ª•ng m·ªõi</h2>
                    <form id="postJobForm" class="space-y-4 sm:space-y-6" onsubmit="handlePostJob(event)">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ti√™u ƒë·ªÅ c√¥ng vi·ªác *</label>
                            <input type="text" id="jobTitle" required placeholder="VD: Backend Developer (Java/Spring Boot)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·ªãa ƒëi·ªÉm *</label>
                                <select id="jobLocation" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Ch·ªçn ƒë·ªãa ƒëi·ªÉm</option>
                                    <option value="H√† N·ªôi">H√† N·ªôi</option>
                                    <option value="TP. H·ªì Ch√≠ Minh">TP. H·ªì Ch√≠ Minh</option>
                                    <option value="ƒê√† N·∫µng">ƒê√† N·∫µng</option>
                                    <option value="Kh√°c">Kh√°c</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">M·ª©c l∆∞∆°ng (tri·ªáu VND)</label>
                                <div class="flex gap-2">
                                    <input type="number" id="jobMinSalary" placeholder="T·ª´" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <input type="number" id="jobMaxSalary" placeholder="ƒê·∫øn" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kinh nghi·ªám y√™u c·∫ßu</label>
                            <select id="jobExperience" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Kh√¥ng y√™u c·∫ßu</option>
                                <option value="FRESHER">Fresher</option>
                                <option value="JUNIOR">1-2 nƒÉm</option>
                                <option value="MIDDLE">2-5 nƒÉm</option>
                                <option value="SENIOR">Tr√™n 5 nƒÉm</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i c√¥ng vi·ªác</label>
                            <select id="jobType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="FULL_TIME">Full-time</option>
                                <option value="PART_TIME">Part-time</option>
                                <option value="CONTRACT">H·ª£p ƒë·ªìng</option>
                                <option value="INTERNSHIP">Th·ª±c t·∫≠p</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£ c√¥ng vi·ªác *</label>
                            <textarea id="jobDescription" rows="6" placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ c√¥ng vi·ªác, tr√°ch nhi·ªám..." required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Y√™u c·∫ßu ·ª©ng vi√™n</label>
                            <textarea id="jobRequirements" rows="4" placeholder="C√°c y√™u c·∫ßu c·ª• th·ªÉ v·ªÅ tr√¨nh ƒë·ªô, k·ªπ nƒÉng..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">K·ªπ nƒÉng y√™u c·∫ßu (ph√¢n c√°ch b·∫±ng d·∫•u ph·∫©y) *</label>
                            <input type="text" id="requiredSkills" required placeholder="VD: Java, Spring Boot, MySQL" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <p class="text-xs text-gray-500 mt-1">C√°c k·ªπ nƒÉng b·∫Øt bu·ªôc ·ª©ng vi√™n ph·∫£i c√≥</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">K·ªπ nƒÉng ∆∞u ti√™n (t√πy ch·ªçn)</label>
                            <input type="text" id="optionalSkills" placeholder="VD: Docker, Kubernetes, AWS" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <p class="text-xs text-gray-500 mt-1">C√°c k·ªπ nƒÉng s·∫Ω ƒë∆∞·ª£c ∆∞u ti√™n nh∆∞ng kh√¥ng b·∫Øt bu·ªôc</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ng√†y h·∫øt h·∫°n</label>
                                <input type="date" id="jobExpiresAt" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">S·ªë l∆∞·ª£ng tuy·ªÉn</label>
                                <input type="number" id="jobQuantity" placeholder="VD: 2" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 pt-4">
                            <button type="submit" id="submitJobBtn" class="flex-1 px-4 sm:px-6 py-2.5 sm:py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition shadow-lg text-sm sm:text-base">
                                <i class="fas fa-paper-plane mr-2"></i>ƒêƒÉng tin ngay
                            </button>
                            <button type="button" onclick="saveDraft()" class="px-4 sm:px-6 py-2.5 sm:py-3 border border-gray-300 rounded-lg font-semibold hover:bg-gray-50 transition text-sm sm:text-base">
                                L∆∞u nh√°p
                            </button>
                        </div>
                    </form>
                </div>

                <!-- My Job Posts -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6">
                    <h3 class="text-base sm:text-lg font-bold text-gray-900 mb-3 sm:mb-4">Tin tuy·ªÉn d·ª•ng c·ªßa t√¥i</h3>
                    <div class="space-y-3 sm:space-y-4" id="myJobsList">
                        <div class="border border-gray-200 rounded-lg p-3 sm:p-4 hover:bg-gray-50 transition">
                            <div class="flex flex-col sm:flex-row items-start justify-between gap-3">
                                <div class="flex-1 min-w-0">
                                    <div class="flex flex-wrap items-center gap-2 sm:gap-3 mb-2">
                                        <h4 class="font-semibold text-gray-900 text-sm sm:text-base">Backend Developer (Java/Spring Boot)</h4>
                                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded whitespace-nowrap">ƒêang tuy·ªÉn</span>
                                    </div>
                                    <p class="text-xs sm:text-sm text-gray-600 mb-1 sm:mb-2">H√† N·ªôi ‚Ä¢ 15-20 tri·ªáu ‚Ä¢ H·∫øt h·∫°n: 30/12/2025</p>
                                    <p class="text-xs text-gray-500">12 ·ª©ng vi√™n ‚Ä¢ 3 ƒë√£ ph·ªèng v·∫•n</p>
                                </div>
                                <div class="flex gap-2 sm:ml-4">
                                    <button class="px-2 sm:px-3 py-1 text-blue-600 hover:bg-blue-50 rounded text-sm">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="px-2 sm:px-3 py-1 text-gray-600 hover:bg-gray-50 rounded text-sm">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Job Matching Tab Content -->
    <div id="job-matching" class="tab-content">
        <main class="flex-1 overflow-y-auto p-4 sm:p-6">
            <div class="max-w-7xl mx-auto">
                <div class="mb-4 sm:mb-6">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-2">G·ª£i √Ω ·ª©ng vi√™n ph√π h·ª£p</h2>
                    <p class="text-sm sm:text-base text-gray-600">AI s·∫Ω t·ª± ƒë·ªông t√¨m ki·∫øm v√† ƒë·ªÅ xu·∫•t ·ª©ng vi√™n ph√π h·ª£p v·ªõi y√™u c·∫ßu c√¥ng vi·ªác c·ªßa b·∫°n</p>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6 mb-4 sm:mb-6">
                    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 mb-3 sm:mb-4">
                        <select id="matchingJobSelector" class="flex-1 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base">
                            <option value="">Ch·ªçn tin tuy·ªÉn d·ª•ng</option>
                        </select>
                        <button onclick="findMatchingCandidates()" class="px-4 sm:px-6 py-2 sm:py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition text-sm sm:text-base">
                            <i class="fas fa-search mr-2"></i>T√¨m ·ª©ng vi√™n
                        </button>
                    </div>
                    <div id="matchingInfo" class="flex items-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600">
                        <span><i class="fas fa-info-circle text-blue-500 mr-1"></i>Ch·ªçn tin tuy·ªÉn d·ª•ng ƒë·ªÉ t√¨m ·ª©ng vi√™n ph√π h·ª£p</span>
                    </div>
                </div>

                <div id="matchingCandidates" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition hidden">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold text-lg">NA</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">Nguy·ªÖn VƒÉn A</h4>
                                    <p class="text-xs text-gray-500">Backend Developer</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded">95%</span>
                        </div>
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-2">2 nƒÉm kinh nghi·ªám ‚Ä¢ ƒê·∫°i h·ªçc B√°ch Khoa</p>
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Java</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Spring Boot</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">MySQL</span>
                            </div>
                            <div class="text-xs bg-blue-50 text-blue-700 p-2 rounded">
                                <i class="fas fa-lightbulb mr-1"></i>·ª®ng vi√™n c√≥ portfolio GitHub ·∫•n t∆∞·ª£ng
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition">
                                <i class="fas fa-eye mr-1"></i>Xem CV
                            </button>
                            <button class="flex-1 py-2 border border-gray-300 rounded-lg text-sm font-medium hover:bg-gray-50 transition">
                                <i class="fas fa-paper-plane mr-1"></i>M·ªùi ·ª©ng tuy·ªÉn
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="h-12 w-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-700 font-bold text-lg">TB</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">Tr·∫ßn Th·ªã B</h4>
                                    <p class="text-xs text-gray-500">Fullstack Developer</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-bold rounded">88%</span>
                        </div>
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-2">1.5 nƒÉm kinh nghi·ªám ‚Ä¢ Ch·ª©ng ch·ªâ AWS</p>
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Java</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">React</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">AWS</span>
                            </div>
                            <div class="text-xs bg-blue-50 text-blue-700 p-2 rounded">
                                <i class="fas fa-lightbulb mr-1"></i>C√≥ kinh nghi·ªám l√†m vi·ªác v·ªõi microservices
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition">
                                <i class="fas fa-eye mr-1"></i>Xem CV
                            </button>
                            <button class="flex-1 py-2 border border-gray-300 rounded-lg text-sm font-medium hover:bg-gray-50 transition">
                                <i class="fas fa-paper-plane mr-1"></i>M·ªùi ·ª©ng tuy·ªÉn
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="h-12 w-12 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-bold text-lg">LC</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">L√™ VƒÉn C</h4>
                                    <p class="text-xs text-gray-500">Backend Developer</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded">92%</span>
                        </div>
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-2">3 nƒÉm kinh nghi·ªám ‚Ä¢ ƒê·∫°i h·ªçc C√¥ng ngh·ªá</p>
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Java</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Spring</span>
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">Docker</span>
                            </div>
                            <div class="text-xs bg-blue-50 text-blue-700 p-2 rounded">
                                <i class="fas fa-lightbulb mr-1"></i>ƒê√£ t·ª´ng l√†m vi·ªác t·∫°i startup c√¥ng ngh·ªá
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition">
                                <i class="fas fa-eye mr-1"></i>Xem CV
                            </button>
                            <button class="flex-1 py-2 border border-gray-300 rounded-lg text-sm font-medium hover:bg-gray-50 transition">
                                <i class="fas fa-paper-plane mr-1"></i>M·ªùi ·ª©ng tuy·ªÉn
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- VIP Package Tab Content -->
    <div id="vip" class="tab-content">
        <main class="flex-1 overflow-y-auto p-4 sm:p-6">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-6 sm:mb-8">
                    <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">N√¢ng c·∫•p g√≥i VIP</h2>
                    <p class="text-sm sm:text-base text-gray-600">TƒÉng hi·ªáu qu·∫£ tuy·ªÉn d·ª•ng v·ªõi c√°c t√≠nh nƒÉng ƒë·ªôc quy·ªÅn</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8">
                    <!-- Basic Package -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">G√≥i C∆° b·∫£n</h3>
                            <div class="mb-4">
                                <span class="text-3xl font-bold text-gray-900">Mi·ªÖn ph√≠</span>
                            </div>
                            <p class="text-sm text-gray-600">Ph√π h·ª£p cho doanh nghi·ªáp nh·ªè</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                ƒêƒÉng 3 tin tuy·ªÉn d·ª•ng/th√°ng
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Xem 20 CV/th√°ng
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                H·ªó tr·ª£ email
                            </li>
                        </ul>
                        <button class="w-full py-3 border-2 border-gray-300 rounded-lg font-semibold hover:bg-gray-50 transition">
                            G√≥i hi·ªán t·∫°i
                        </button>
                    </div>

                    <!-- Gold Package -->
                    <div class="bg-white rounded-xl shadow-lg border-2 border-yellow-400 p-6 relative">
                        <div class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 px-4 py-1 rounded-bl-lg text-xs font-bold">
                            PH·ªî BI·∫æN
                        </div>
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">G√≥i Gold</h3>
                            <div class="mb-4">
                                <span class="text-3xl font-bold text-gray-900">2.990.000ƒë</span>
                                <span class="text-gray-500">/th√°ng</span>
                            </div>
                            <p class="text-sm text-gray-600">Ph√π h·ª£p cho doanh nghi·ªáp v·ª´a</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                ƒêƒÉng kh√¥ng gi·ªõi h·∫°n tin tuy·ªÉn d·ª•ng
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Xem kh√¥ng gi·ªõi h·∫°n CV
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                G·ª£i √Ω ·ª©ng vi√™n AI
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                ∆Øu ti√™n hi·ªÉn th·ªã tin ƒëƒÉng
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                H·ªó tr·ª£ 24/7
                            </li>
                        </ul>
                        <button class="w-full py-3 bg-yellow-400 text-yellow-900 rounded-lg font-semibold hover:bg-yellow-500 transition">
                            G√≥i hi·ªán t·∫°i
                        </button>
                    </div>

                    <!-- Platinum Package -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <div class="text-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">G√≥i Platinum</h3>
                            <div class="mb-4">
                                <span class="text-3xl font-bold text-gray-900">5.990.000ƒë</span>
                                <span class="text-gray-500">/th√°ng</span>
                            </div>
                            <p class="text-sm text-gray-600">Ph√π h·ª£p cho doanh nghi·ªáp l·ªõn</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                T·∫•t c·∫£ t√≠nh nƒÉng Gold
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Qu·∫£n l√Ω nhi·ªÅu t√†i kho·∫£n
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                B√°o c√°o chi ti·∫øt n√¢ng cao
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                T√≠ch h·ª£p API
                            </li>
                            <li class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Account Manager ri√™ng
                            </li>
                        </ul>
                        <button class="w-full py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
                            N√¢ng c·∫•p ngay
                        </button>
                    </div>
                </div>

                <!-- Current Package Info -->
                <div class="bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-xl p-4 sm:p-6 text-white">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0">
                        <div>
                            <h3 class="text-lg sm:text-xl font-bold mb-1">G√≥i Gold c·ªßa b·∫°n</h3>
                            <p class="text-yellow-100 text-sm sm:text-base">H·∫øt h·∫°n: 30/01/2026 ‚Ä¢ C√≤n 40 ng√†y</p>
                        </div>
                        <button class="w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 bg-white text-yellow-600 rounded-lg font-semibold hover:bg-yellow-50 transition text-sm sm:text-base">
                            Gia h·∫°n ngay
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Dashboard Tab Content -->
    <div id="dashboard" class="tab-content">
        <main class="flex-1 overflow-y-auto p-4 sm:p-6">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">Dashboard</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-6 mb-4 sm:mb-6">
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <div class="h-12 w-12 rounded-lg bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-briefcase text-blue-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 mb-1">Tin ƒëang tuy·ªÉn</p>
                        <p class="text-2xl font-bold text-gray-900">5</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <div class="h-12 w-12 rounded-lg bg-green-100 flex items-center justify-center">
                                <i class="fas fa-user-check text-green-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 mb-1">·ª®ng vi√™n m·ªõi</p>
                        <p class="text-2xl font-bold text-gray-900">23</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <div class="h-12 w-12 rounded-lg bg-purple-100 flex items-center justify-center">
                                <i class="fas fa-calendar-check text-purple-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 mb-1">Ph·ªèng v·∫•n s·∫Øp t·ªõi</p>
                        <p class="text-2xl font-bold text-gray-900">3</p>
                    </div>
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <div class="h-12 w-12 rounded-lg bg-orange-100 flex items-center justify-center">
                                <i class="fas fa-handshake text-orange-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 mb-1">ƒê√£ tuy·ªÉn th√†nh c√¥ng</p>
                        <p class="text-2xl font-bold text-gray-900">8</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- AI Chat Widget -->
    <div class="chat-widget">
        <button class="chat-button" id="chatToggle">
            <i class="fas fa-comments"></i>
        </button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <h3>
                    <i class="fas fa-robot"></i>
                    CareerMate AI
                </h3>
                <button class="chat-close" id="chatClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="quick-actions" id="quickActions">
                <button class="quick-action-btn" onclick="sendQuickMessage('C√°ch vi·∫øt tin tuy·ªÉn d·ª•ng hi·ªáu qu·∫£')">
                    ‚úçÔ∏è Vi·∫øt tin tuy·ªÉn d·ª•ng
                </button>
                <button class="quick-action-btn" onclick="sendQuickMessage('C√°ch ƒë√°nh gi√° ·ª©ng vi√™n')">
                    üë• ƒê√°nh gi√° ·ª©ng vi√™n
                </button>
                <button class="quick-action-btn" onclick="sendQuickMessage('C√¢u h·ªèi ph·ªèng v·∫•n hay')">
                    üí¨ C√¢u h·ªèi ph·ªèng v·∫•n
                </button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message ai">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        Xin ch√†o! T√¥i l√† CareerMate AI, tr·ª£ l√Ω tuy·ªÉn d·ª•ng c·ªßa b·∫°n. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n:
                        <br>‚Ä¢ Vi·∫øt v√† t·ªëi ∆∞u tin tuy·ªÉn d·ª•ng
                        <br>‚Ä¢ ƒê√°nh gi√° v√† s√†ng l·ªçc ·ª©ng vi√™n
                        <br>‚Ä¢ G·ª£i √Ω c√¢u h·ªèi ph·ªèng v·∫•n
                        <br>‚Ä¢ T∆∞ v·∫•n chi·∫øn l∆∞·ª£c tuy·ªÉn d·ª•ng
                        <br><br>B·∫°n c·∫ßn h·ªó tr·ª£ g√¨ h√¥m nay?
                    </div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="file" id="cvUpload" class="file-input-hidden" accept=".txt,.doc,.docx,.pdf">
                <button class="chat-upload" onclick="document.getElementById('cvUpload').click()" title="Upload CV ƒë·ªÉ ph√¢n t√≠ch">
                    <i class="fas fa-file-upload"></i>
                </button>
                <input type="text" class="chat-input" id="chatInput" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n..." onkeypress="handleChatKeyPress(event)">
                <button class="chat-send" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Export showTab immediately before anything else to make it available for onclick
        window.showTab = function(tabId, event) {
            // Prevent default anchor behavior
            if (event) {
                event.preventDefault();
            }
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            const tabElement = document.getElementById(tabId);
            if (tabElement) {
                tabElement.classList.add('active');
            } else {
                console.error('Tab not found:', tabId);
                return;
            }
            
            // Update active link in desktop menu
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('text-blue-600');
            });
            
            // Update active link in mobile menu
            document.querySelectorAll('#mobile-menu a').forEach(link => {
                link.classList.remove('text-blue-600', 'bg-blue-50', 'font-medium');
                link.classList.add('text-gray-700');
            });
            
            // Find and highlight the clicked link
            if (event && event.target) {
                const target = event.target.closest('a');
                if (target) {
                    target.classList.add('text-blue-600');
                    if (target.closest('#mobile-menu')) {
                        target.classList.add('bg-blue-50', 'font-medium');
                        target.classList.remove('text-gray-700');
                    }
                }
            } else {
                // Find link by href
                const desktopLink = document.querySelector(`.tab-link[href="#${tabId}"]`);
                if (desktopLink) {
                    desktopLink.classList.add('text-blue-600');
                }
                
                const mobileLink = document.querySelector(`#mobile-menu a[href="#${tabId}"]`);
                if (mobileLink) {
                    mobileLink.classList.add('text-blue-600', 'bg-blue-50', 'font-medium');
                    mobileLink.classList.remove('text-gray-700');
                }
            }
            
            // Close mobile menu
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenu) {
                mobileMenu.classList.remove('active');
            }

            // Update URL hash without triggering scroll
            if (window.location.hash !== `#${tabId}`) {
                history.replaceState(null, null, `#${tabId}`);
            }

            // Load data for specific tabs
            if (tabId === 'dashboard') {
                loadDashboardStats();
            } else if (tabId === 'applicants') {
                loadFirstJobApplicants();
            } else if (tabId === 'post-job') {
                loadMyJobs();
                checkCompanyExists(); // Check company when switching to post-job tab
            } else if (tabId === 'job-matching') {
                updateMatchingJobSelector();
            }
        };

        // Handle hash change
        function handleHashChange() {
            const hash = window.location.hash.substring(1); // Remove #
            if (hash) {
                const validTabs = ['dashboard', 'post-job', 'applicants', 'job-matching', 'vip'];
                if (validTabs.includes(hash)) {
                    window.showTab(hash);
                }
            }
        }

        // Initialize tab from URL hash on page load
        function initializeTab() {
            try {
                const hash = window.location.hash.substring(1);
                const validTabs = ['dashboard', 'post-job', 'applicants', 'job-matching', 'vip'];
                
                if (hash && validTabs.includes(hash)) {
                    window.showTab(hash);
                } else {
                    // Default to dashboard if no hash
                    window.showTab('dashboard');
                }
            } catch (error) {
                console.error('Error initializing tab:', error);
                // Fallback: show dashboard
                const dashboardTab = document.getElementById('dashboard');
                if (dashboardTab) {
                    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
                    dashboardTab.classList.add('active');
                }
            }
        }

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
            });
        }

        // AI Chat Widget - S·ª≠ d·ª•ng CareerMateAI class t·ª´ chat-ai.js
        const GEMINI_API_KEY = 'AIzaSyDbHY-D_6F42UgKuAZRwYIfZWSWi0WLWIE';
        
        // System prompt cho nh√† tuy·ªÉn d·ª•ng
        const systemPrompt = `B·∫°n l√† CareerMate AI, m·ªôt tr·ª£ l√Ω tuy·ªÉn d·ª•ng chuy√™n nghi·ªáp gi√∫p ƒë·ª° nh√† tuy·ªÉn d·ª•ng. 
Nhi·ªám v·ª• ch√≠nh c·ªßa b·∫°n:
1. Vi·∫øt v√† t·ªëi ∆∞u h√≥a tin tuy·ªÉn d·ª•ng ƒë·ªÉ thu h√∫t ·ª©ng vi√™n ch·∫•t l∆∞·ª£ng
2. ƒê√°nh gi√° v√† s√†ng l·ªçc ·ª©ng vi√™n d·ª±a tr√™n CV v√† h·ªì s∆°
3. G·ª£i √Ω c√¢u h·ªèi ph·ªèng v·∫•n ph√π h·ª£p v·ªõi v·ªã tr√≠ tuy·ªÉn d·ª•ng
4. T∆∞ v·∫•n chi·∫øn l∆∞·ª£c tuy·ªÉn d·ª•ng hi·ªáu qu·∫£
5. H·ªó tr·ª£ quy tr√¨nh tuy·ªÉn d·ª•ng t·ª´ A-Z

H√£y tr·∫£ l·ªùi m·ªôt c√°ch chuy√™n nghi·ªáp, th·ª±c t·∫ø v√† h·ªØu √≠ch. Lu√¥n tr·∫£ l·ªùi b·∫±ng ti·∫øng Vi·ªát.`;

        // Kh·ªüi t·∫°o CareerMateAI instance
        let chatAI;
        document.addEventListener('DOMContentLoaded', () => {
            chatAI = new CareerMateAI({
                apiKey: GEMINI_API_KEY,
                systemPrompt: systemPrompt,
                proxyUrl: 'gemini-proxy.php',
                role: 'recruiter' // Role cho nh√† tuy·ªÉn d·ª•ng
            });
        });

        // Wrapper functions ƒë·ªÉ t∆∞∆°ng th√≠ch v·ªõi onclick handlers
        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && chatAI) {
                chatAI.sendMessage();
            }
        }

        function sendMessage() {
            if (chatAI) {
                chatAI.sendMessage();
            }
        }

        function sendQuickMessage(message) {
            if (chatAI) {
                chatAI.sendQuickMessage(message);
            }
        }

        // Handle post job form
        async function handlePostJob(event) {
            event.preventDefault();
            const submitBtn = document.getElementById('submitJobBtn');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>ƒêang ƒëƒÉng tin...';

                const formData = {
                    title: document.getElementById('jobTitle').value,
                    description: document.getElementById('jobDescription').value,
                    requirements: document.getElementById('jobRequirements').value,
                    location: document.getElementById('jobLocation').value,
                    jobType: document.getElementById('jobType').value || 'FULL_TIME',
                    experienceLevel: document.getElementById('jobExperience').value || 'ENTRY',
                    minSalary: document.getElementById('jobMinSalary').value ? parseFloat(document.getElementById('jobMinSalary').value) * 1000000 : null,
                    maxSalary: document.getElementById('jobMaxSalary').value ? parseFloat(document.getElementById('jobMaxSalary').value) * 1000000 : null,
                    currency: 'VND',
                    expiresAt: document.getElementById('jobExpiresAt').value ? new Date(document.getElementById('jobExpiresAt').value).toISOString() : null
                };

                const requiredSkills = document.getElementById('requiredSkills').value.split(',').map(s => s.trim()).filter(s => s);
                const optionalSkills = document.getElementById('optionalSkills').value ? document.getElementById('optionalSkills').value.split(',').map(s => s.trim()).filter(s => s) : [];

                const job = await window.api.createJob(formData, requiredSkills, optionalSkills);
                alert('ƒêƒÉng tin th√†nh c√¥ng! Tin ƒëƒÉng ƒëang ch·ªù duy·ªát t·ª´ admin.');
                document.getElementById('postJobForm').reset();
                loadMyJobs();
            } catch (error) {
                console.error('Error posting job:', error);
                const errorMessage = error.message || 'Kh√¥ng th·ªÉ ƒëƒÉng tin. Vui l√≤ng th·ª≠ l·∫°i.';
                
                // Check if error is about missing company
                if (errorMessage.includes('company') || errorMessage.includes('Recruiter must have a company')) {
                    const shouldCreate = confirm(
                        'B·∫°n ch∆∞a c√≥ th√¥ng tin c√¥ng ty.\n\n' +
                        'B·∫°n c·∫ßn t·∫°o th√¥ng tin c√¥ng ty tr∆∞·ªõc khi ƒëƒÉng tin tuy·ªÉn d·ª•ng.\n\n' +
                        'B·∫•m OK ƒë·ªÉ chuy·ªÉn ƒë·∫øn trang t·∫°o th√¥ng tin c√¥ng ty.'
                    );
                    if (shouldCreate) {
                        window.location.href = 'recruiter-company.html';
                    }
                } else {
                    alert('L·ªói: ' + errorMessage);
                }
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        function saveDraft() {
            // TODO: Implement save draft functionality
            alert('T√≠nh nƒÉng l∆∞u nh√°p ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
        }

        // Load dashboard stats
        async function loadDashboardStats() {
            try {
                const jobsData = await window.api.getMyJobs(0, 100);
                const jobs = jobsData.content || jobsData || [];
                
                const activeJobs = jobs.filter(j => j.status === 'ACTIVE').length;
                let totalApplicants = 0;
                let upcomingInterviews = 0;
                let successfulHires = 0;

                for (const job of jobs) {
                    try {
                        const applicants = await window.api.getJobApplicants(job.id, 0, 100);
                        const apps = applicants.content || applicants || [];
                        totalApplicants += apps.length;
                        upcomingInterviews += apps.filter(a => a.status === 'INTERVIEW' && a.interviewScheduledAt).length;
                        successfulHires += apps.filter(a => a.status === 'OFFERED' || a.status === 'ACCEPTED').length;
                    } catch (e) {
                        console.error('Error loading applicants:', e);
                    }
                }

                // Update stats display
                const statsContainer = document.querySelector('#dashboard .grid');
                if (statsContainer) {
                    const stats = statsContainer.querySelectorAll('p.text-2xl');
                    if (stats.length >= 4) {
                        stats[0].textContent = activeJobs;
                        stats[1].textContent = totalApplicants;
                        stats[2].textContent = upcomingInterviews;
                        stats[3].textContent = successfulHires;
                    }
                }
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
                // Show friendly message if recruiter profile not found
                if (error.message && error.message.includes('Recruiter profile not found')) {
                    showRecruiterProfileRequired();
                }
            }
        }

        // Check if recruiter has company
        async function checkCompanyExists() {
            try {
                const company = await window.api.getMyCompany();
                const warningDiv = document.getElementById('companyRequiredWarning');
                if (warningDiv) {
                    if (company) {
                        warningDiv.classList.add('hidden');
                    } else {
                        warningDiv.classList.remove('hidden');
                    }
                }
                return company !== null;
            } catch (error) {
                // If 404, company doesn't exist
                const warningDiv = document.getElementById('companyRequiredWarning');
                if (warningDiv) {
                    warningDiv.classList.remove('hidden');
                }
                return false;
            }
        }

        // Check if recruiter has company
        async function checkCompanyExists() {
            try {
                const company = await window.api.getMyCompany();
                const warningDiv = document.getElementById('companyRequiredWarning');
                if (warningDiv) {
                    if (company) {
                        warningDiv.classList.add('hidden');
                    } else {
                        warningDiv.classList.remove('hidden');
                    }
                }
                return company !== null;
            } catch (error) {
                // If 404, company doesn't exist
                const warningDiv = document.getElementById('companyRequiredWarning');
                if (warningDiv) {
                    warningDiv.classList.remove('hidden');
                }
                return false;
            }
        }

        // Load my jobs
        async function loadMyJobs() {
            try {
                const jobsData = await window.api.getMyJobs(0, 50);
                const jobs = jobsData.content || jobsData || [];
                const container = document.getElementById('myJobsList');
                const jobSelector = document.getElementById('jobSelector');
                
                if (!container) return;

                // Update job selector
                if (jobSelector) {
                    jobSelector.innerHTML = '<option value="">Ch·ªçn tin tuy·ªÉn d·ª•ng</option>' + 
                        jobs.map(job => `<option value="${job.id}">${job.title || 'Ch∆∞a c√≥ ti√™u ƒë·ªÅ'}</option>`).join('');
                }

                if (jobs.length === 0) {
                    if (container) container.innerHTML = '<div class="text-center p-8 text-gray-500">Ch∆∞a c√≥ tin tuy·ªÉn d·ª•ng n√†o</div>';
                    return;
                }

                container.innerHTML = jobs.map(job => {
                    const statusClass = job.status === 'ACTIVE' ? 'green' : job.status === 'PENDING' ? 'yellow' : 'gray';
                    const statusText = job.status === 'ACTIVE' ? 'ƒêang tuy·ªÉn' : job.status === 'PENDING' ? 'Ch·ªù duy·ªát' : job.status === 'CLOSED' ? 'ƒê√£ ƒë√≥ng' : 'Nh√°p';
                    
                    return `
                        <div class="border border-gray-200 rounded-lg p-3 sm:p-4 hover:bg-gray-50 transition">
                            <div class="flex flex-col sm:flex-row items-start justify-between gap-3">
                                <div class="flex-1 min-w-0">
                                    <div class="flex flex-wrap items-center gap-2 sm:gap-3 mb-2">
                                        <h4 class="font-semibold text-gray-900 text-sm sm:text-base">${job.title || 'Ch∆∞a c√≥ ti√™u ƒë·ªÅ'}</h4>
                                        <span class="px-2 py-1 bg-${statusClass}-100 text-${statusClass}-700 text-xs font-medium rounded whitespace-nowrap">
                                            ${statusText}
                                        </span>
                                    </div>
                                    <p class="text-xs sm:text-sm text-gray-600 mb-1 sm:mb-2">
                                        ${job.location || 'Ch∆∞a c√≥ ƒë·ªãa ƒëi·ªÉm'} ‚Ä¢ ${formatCurrency(job.minSalary, job.currency)} ‚Ä¢ H·∫øt h·∫°n: ${formatDate(job.expiresAt)}
                                    </p>
                                    <p class="text-xs text-gray-500">${job.applicationsCount || 0} ·ª©ng vi√™n</p>
                                </div>
                                <div class="flex gap-2 sm:ml-4">
                                    <button onclick="viewJobDetail('${job.id}')" class="px-2 sm:px-3 py-1 text-blue-600 hover:bg-blue-50 rounded text-sm" title="Chi ti·∫øt">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button onclick="viewJobApplicants('${job.id}')" class="px-2 sm:px-3 py-1 text-green-600 hover:bg-green-50 rounded text-sm" title="Xem ·ª©ng vi√™n">
                                        <i class="fas fa-users"></i>
                                    </button>
                                    <button onclick="editJob('${job.id}')" class="px-2 sm:px-3 py-1 text-gray-600 hover:bg-gray-50 rounded text-sm" title="S·ª≠a">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading jobs:', error);
                // Show friendly message if recruiter profile not found
                if (error.message && error.message.includes('Recruiter profile not found')) {
                    const container = document.getElementById('myJobsList');
                    if (container) {
                        container.innerHTML = `
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center">
                                <i class="fas fa-exclamation-triangle text-yellow-600 text-3xl mb-3"></i>
                                <h3 class="text-lg font-semibold text-yellow-800 mb-2">Ch∆∞a c√≥ h·ªì s∆° nh√† tuy·ªÉn d·ª•ng</h3>
                                <p class="text-sm text-yellow-700 mb-4">B·∫°n c·∫ßn t·∫°o h·ªì s∆° nh√† tuy·ªÉn d·ª•ng tr∆∞·ªõc khi s·ª≠ d·ª•ng c√°c ch·ª©c nƒÉng n√†y.</p>
                                <a href="recruiter-profile.html" class="inline-block px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition">
                                    <i class="fas fa-user-plus mr-2"></i>T·∫°o h·ªì s∆° ngay
                                </a>
                            </div>
                        `;
                    }
                }
            }
        }

        // Load first job applicants
        async function loadFirstJobApplicants() {
            try {
                const jobsData = await window.api.getMyJobs(0, 1);
                const jobs = jobsData.content || jobsData || [];
                if (jobs.length > 0) {
                    currentJobId = jobs[0].id;
                    await loadJobApplicants(jobs[0].id);
                    updateJobHeader(jobs[0]);
                } else {
                    // Show message if no jobs
                    const header = document.getElementById('currentJobTitle');
                    if (header) {
                        header.textContent = 'Ch∆∞a c√≥ tin tuy·ªÉn d·ª•ng';
                    }
                }
            } catch (error) {
                console.error('Error loading first job:', error);
                // Show friendly message if recruiter profile not found
                if (error.message && error.message.includes('Recruiter profile not found')) {
                    showRecruiterProfileRequired();
                }
            }
        }

        // Load job applicants
        async function loadJobApplicants(jobId) {
            try {
                currentJobId = jobId;
                const applicantsData = await window.api.getJobApplicants(jobId, 0, 100);
                const applicants = applicantsData.content || applicantsData || [];
                updateApplicantsKanban(applicants);
            } catch (error) {
                console.error('Error loading applicants:', error);
            }
        }

        function updateJobHeader(job) {
            const header = document.querySelector('#applicants header');
            if (header && job) {
                const title = document.getElementById('currentJobTitle');
                const status = document.getElementById('currentJobStatus');
                const info = document.getElementById('currentJobInfo');
                
                if (title) title.textContent = job.title || 'Ch∆∞a c√≥ ti√™u ƒë·ªÅ';
                if (status) {
                    const statusClass = job.status === 'ACTIVE' ? 'green' : job.status === 'PENDING' ? 'yellow' : 'gray';
                    const statusText = job.status === 'ACTIVE' ? 'ƒêang tuy·ªÉn' : job.status === 'PENDING' ? 'Ch·ªù duy·ªát' : job.status === 'CLOSED' ? 'ƒê√£ ƒë√≥ng' : 'Nh√°p';
                    status.className = `px-2 py-0.5 rounded-full text-xs font-medium bg-${statusClass}-100 text-${statusClass}-800 whitespace-nowrap`;
                    status.textContent = statusText;
                }
                if (info) {
                    info.innerHTML = `ID: ${job.id ? job.id.substring(0, 8) : 'N/A'} ‚Ä¢ H·∫øt h·∫°n: ${formatDate(job.expiresAt)} ‚Ä¢ ${job.location || 'Ch∆∞a c√≥ ƒë·ªãa ƒëi·ªÉm'}`;
                }
            }
        }

        function updateApplicantsKanban(applicants) {
            const columns = {
                new: applicants.filter(a => a.status === 'PENDING'),
                viewed: applicants.filter(a => a.status === 'VIEWED'),
                interview: applicants.filter(a => a.status === 'INTERVIEW'),
                offered: applicants.filter(a => a.status === 'OFFERED' || a.status === 'ACCEPTED')
            };

            // Update column counts
            updateKanbanColumn('new', columns.new);
            updateKanbanColumn('viewed', columns.viewed);
            updateKanbanColumn('interview', columns.interview);
            updateKanbanColumn('offered', columns.offered);
        }

        function updateKanbanColumn(columnType, applicants) {
            let container;
            if (columnType === 'new') {
                container = document.querySelector('#applicants .kanban-column:first-child .space-y-2, #applicants .kanban-column:first-child .space-y-3');
            } else if (columnType === 'viewed') {
                container = document.querySelectorAll('#applicants .kanban-column')[1]?.querySelector('.space-y-2, .space-y-3');
            } else if (columnType === 'interview') {
                container = document.querySelectorAll('#applicants .kanban-column')[2]?.querySelector('.space-y-2, .space-y-3');
            } else if (columnType === 'offered') {
                container = document.querySelectorAll('#applicants .kanban-column')[3]?.querySelector('.space-y-2, .space-y-3');
            }

            if (!container) return;

            // Update count in header
            const column = container.closest('.kanban-column');
            if (column) {
                const countSpan = column.querySelector('span');
                if (countSpan) {
                    countSpan.textContent = applicants.length;
                }
            }

            container.innerHTML = applicants.map(app => {
                const studentName = app.student?.fullName || app.studentName || '·ª®ng vi√™n';
                const initials = studentName.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                const matchScore = app.matchScore || 0;
                const scoreColor = matchScore >= 80 ? 'green' : matchScore >= 60 ? 'yellow' : 'gray';
                
                return `
                    <div class="bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition cursor-pointer group" data-application-id="${app.id}">
                        <div class="flex justify-between items-start mb-2 gap-2">
                            <h4 class="font-semibold text-gray-900 group-hover:text-blue-600 text-sm sm:text-base flex-1">${studentName}</h4>
                            <span class="text-xs font-bold text-${scoreColor}-600 bg-${scoreColor}-50 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded border border-${scoreColor}-100 whitespace-nowrap">${matchScore}%</span>
                        </div>
                        <p class="text-xs text-gray-500 mb-2 sm:mb-3">${app.appliedAt ? formatDate(app.appliedAt) : 'M·ªõi ·ª©ng tuy·ªÉn'}</p>
                        ${app.cv ? `
                        <div class="flex items-center justify-between mt-2 pt-2 border-t border-gray-50">
                            <span class="text-xs text-gray-400">${formatDateTime(app.appliedAt)}</span>
                            <div class="flex gap-1">
                                ${app.cv ? `<button onclick="viewCV('${app.cv.id || app.cv}')" class="p-1 hover:bg-gray-100 rounded text-gray-500 text-xs sm:text-sm" title="Xem CV">
                                    <i class="fas fa-file-pdf"></i>
                                </button>` : ''}
                                <button onclick="viewApplication('${app.id}')" class="p-1 hover:bg-gray-100 rounded text-blue-500 text-xs sm:text-sm" title="Chi ti·∫øt">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }).join('') || '<div class="text-center text-gray-400 text-xs py-4">Ch∆∞a c√≥ ·ª©ng vi√™n</div>';
        }

        // View job applicants
        async function viewJobApplicants(jobId) {
            showTab('applicants');
            await loadJobApplicants(jobId);
            const jobsData = await window.api.getMyJobs(0, 100);
            const jobs = jobsData.content || jobsData || [];
            const job = jobs.find(j => j.id === jobId);
            if (job) updateJobHeader(job);
            
            // Update job selector
            const jobSelector = document.getElementById('jobSelector');
            if (jobSelector) {
                jobSelector.value = jobId;
            }
        }

        // Navigate to job detail page
        function viewJobDetail(jobId) {
            window.location.href = `recruiter-job-detail.html?id=${jobId}`;
        }

        // View CV
        async function viewCV(cvId) {
            try {
                if (!cvId) {
                    alert('CV ID kh√¥ng h·ª£p l·ªá');
                    return;
                }

                // Try to get CV from backend
                const cv = await window.api.getCV(cvId);
                if (cv && cv.fileUrl) {
                    // If fileUrl is relative, make it absolute
                    let fileUrl = cv.fileUrl;
                    if (!fileUrl.startsWith('http')) {
                        fileUrl = `http://localhost:8080/api/${fileUrl}`;
                    }
                    window.open(fileUrl, '_blank');
                } else {
                    alert('CV kh√¥ng c√≥ file ƒë√≠nh k√®m ho·∫∑c kh√¥ng t√¨m th·∫•y');
                }
            } catch (error) {
                console.error('Error viewing CV:', error);
                // Try to open directly if we have the ID
                try {
                    window.open(`http://localhost:8080/api/files/cvs/${cvId}`, '_blank');
                } catch (e) {
                    alert('L·ªói khi xem CV: ' + (error.message || 'Vui l√≤ng th·ª≠ l·∫°i'));
                }
            }
        }

        // View application details
        async function viewApplication(applicationId) {
            // Navigate to candidate detail page
            if (currentJobId) {
                window.location.href = `recruiter-candidate-detail.html?id=${applicationId}&jobId=${currentJobId}`;
            } else {
                // Try to get job ID from application
                try {
                    const jobsData = await window.api.getMyJobs(0, 100);
                    const jobs = jobsData.content || jobsData || [];
                    // Find job that has this application
                    for (const job of jobs) {
                        const applicantsData = await window.api.getJobApplicants(job.id, 0, 100);
                        const applicants = applicantsData.content || applicantsData || [];
                        if (applicants.some(a => a.id === applicationId)) {
                            window.location.href = `recruiter-candidate-detail.html?id=${applicationId}&jobId=${job.id}`;
                            return;
                        }
                    }
                    alert('Kh√¥ng t√¨m th·∫•y th√¥ng tin ·ª©ng vi√™n');
                } catch (error) {
                    console.error('Error finding job for application:', error);
                    alert('L·ªói khi t·∫£i th√¥ng tin ·ª©ng vi√™n');
                }
            }
        }

        // Edit job
        async function editJob(jobId) {
            try {
                showTab('post-job');
                const jobsData = await window.api.getMyJobs(0, 100);
                const jobs = jobsData.content || jobsData || [];
                const job = jobs.find(j => j.id === jobId);
                
                if (!job) {
                    alert('Kh√¥ng t√¨m th·∫•y tin tuy·ªÉn d·ª•ng');
                    return;
                }

                // Load job data into form
                if (document.getElementById('jobTitle')) document.getElementById('jobTitle').value = job.title || '';
                if (document.getElementById('jobDescription')) document.getElementById('jobDescription').value = job.description || '';
                if (document.getElementById('jobRequirements')) document.getElementById('jobRequirements').value = job.requirements || '';
                if (document.getElementById('jobLocation')) document.getElementById('jobLocation').value = job.location || '';
                if (document.getElementById('jobType')) document.getElementById('jobType').value = job.jobType || 'FULL_TIME';
                if (document.getElementById('jobExperience')) document.getElementById('jobExperience').value = job.experienceRequired || '';
                if (document.getElementById('jobMinSalary')) document.getElementById('jobMinSalary').value = job.minSalary ? (job.minSalary / 1000000) : '';
                if (document.getElementById('jobMaxSalary')) document.getElementById('jobMaxSalary').value = job.maxSalary ? (job.maxSalary / 1000000) : '';
                if (document.getElementById('jobExpiresAt') && job.expiresAt) {
                    const date = new Date(job.expiresAt);
                    document.getElementById('jobExpiresAt').value = date.toISOString().split('T')[0];
                }
                if (document.getElementById('jobQuantity')) document.getElementById('jobQuantity').value = job.quantity || 1;

                // Load skills
                // TODO: Load skills from job.skills if available
                
                alert('ƒê√£ t·∫£i d·ªØ li·ªáu tin ƒëƒÉng. Vui l√≤ng s·ª≠a v√† l∆∞u l·∫°i.');
            } catch (error) {
                console.error('Error loading job for edit:', error);
                alert('L·ªói khi t·∫£i d·ªØ li·ªáu: ' + (error.message || 'Vui l√≤ng th·ª≠ l·∫°i'));
            }
        }

        // Update application status
        async function updateApplicationStatus(applicationId, status) {
            try {
                await window.api.updateApplicationStatus(applicationId, status, '');
                if (currentJobId) {
                    await loadJobApplicants(currentJobId);
                }
            } catch (error) {
                console.error('Error updating status:', error);
                alert('L·ªói: ' + (error.message || 'Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t'));
            }
        }

        // Schedule interview
        async function scheduleInterview(applicationId, interviewTime) {
            try {
                await window.api.scheduleInterview(applicationId, interviewTime);
                if (currentJobId) {
                    await loadJobApplicants(currentJobId);
                }
                alert('ƒê√£ l√™n l·ªãch ph·ªèng v·∫•n th√†nh c√¥ng!');
            } catch (error) {
                console.error('Error scheduling interview:', error);
                alert('L·ªói: ' + (error.message || 'Kh√¥ng th·ªÉ l√™n l·ªãch'));
            }
        }

        // Find matching candidates
        async function findMatchingCandidates() {
            const jobId = document.getElementById('matchingJobSelector').value;
            if (!jobId) {
                alert('Vui l√≤ng ch·ªçn tin tuy·ªÉn d·ª•ng');
                return;
            }

            try {
                // Get job details
                const jobsData = await window.api.getMyJobs(0, 100);
                const jobs = jobsData.content || jobsData || [];
                const job = jobs.find(j => j.id === jobId);
                
                if (!job) {
                    alert('Kh√¥ng t√¨m th·∫•y tin tuy·ªÉn d·ª•ng');
                    return;
                }

                // Get all applicants for this job (they are already matched)
                const applicantsData = await window.api.getJobApplicants(jobId, 0, 50);
                const applicants = applicantsData.content || applicantsData || [];
                
                // Sort by match score
                applicants.sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0));

                displayMatchingCandidates(applicants);
                document.getElementById('matchingInfo').innerHTML = 
                    `<span><i class="fas fa-info-circle text-blue-500 mr-1"></i>ƒê√£ t√¨m th·∫•y ${applicants.length} ·ª©ng vi√™n ph√π h·ª£p</span>`;
            } catch (error) {
                console.error('Error finding candidates:', error);
                alert('L·ªói: ' + (error.message || 'Kh√¥ng th·ªÉ t√¨m ·ª©ng vi√™n'));
            }
        }

        function displayMatchingCandidates(applicants) {
            const container = document.getElementById('matchingCandidates');
            if (!container) return;

            if (applicants.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center p-8 text-gray-500">Kh√¥ng t√¨m th·∫•y ·ª©ng vi√™n ph√π h·ª£p</div>';
                return;
            }

            container.innerHTML = applicants.map(app => {
                const studentName = app.student?.fullName || app.studentName || '·ª®ng vi√™n';
                const initials = studentName.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                const matchScore = app.matchScore || 0;
                const scoreColor = matchScore >= 80 ? 'green' : matchScore >= 60 ? 'yellow' : 'gray';
                const studentProfile = app.student || {};
                
                return `
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold text-lg">${initials}</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">${studentName}</h4>
                                    <p class="text-xs text-gray-500">${studentProfile.major || 'Ch∆∞a c√≥ th√¥ng tin'}</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-${scoreColor}-100 text-${scoreColor}-700 text-xs font-bold rounded">${matchScore}%</span>
                        </div>
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-2">${studentProfile.university || 'Ch∆∞a c√≥ th√¥ng tin'}</p>
                            ${app.cv ? `
                            <div class="text-xs bg-blue-50 text-blue-700 p-2 rounded mb-2">
                                <i class="fas fa-lightbulb mr-1"></i>ƒê√£ c√≥ CV ƒë√≠nh k√®m
                            </div>
                            ` : ''}
                        </div>
                        <div class="flex gap-2">
                            ${app.cv ? `
                            <button onclick="viewCV('${app.cv.id || app.cv}')" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition">
                                <i class="fas fa-eye mr-1"></i>Xem CV
                            </button>
                            ` : '<button class="flex-1 py-2 bg-gray-300 text-gray-600 rounded-lg text-sm font-medium cursor-not-allowed">Ch∆∞a c√≥ CV</button>'}
                            <button onclick="inviteCandidate('${app.student?.id || app.studentId}', '${currentJobId || ''}')" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm font-medium hover:bg-gray-50 transition">
                                <i class="fas fa-paper-plane mr-1"></i>M·ªùi ·ª©ng tuy·ªÉn
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function inviteCandidate(studentId, jobId) {
            if (!jobId) {
                alert('Vui l√≤ng ch·ªçn tin tuy·ªÉn d·ª•ng tr∆∞·ªõc');
                return;
            }
            // TODO: Implement invite candidate functionality
            alert('T√≠nh nƒÉng m·ªùi ·ª©ng vi√™n ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
        }

        // Update job selector in matching tab
        async function updateMatchingJobSelector() {
            const selector = document.getElementById('matchingJobSelector');
            if (!selector) return;

            try {
                const jobsData = await window.api.getMyJobs(0, 100);
                const jobs = jobsData.content || jobsData || [];
                selector.innerHTML = '<option value="">Ch·ªçn tin tuy·ªÉn d·ª•ng</option>' + 
                    jobs.map(job => `<option value="${job.id}">${job.title || 'Ch∆∞a c√≥ ti√™u ƒë·ªÅ'}</option>`).join('');
            } catch (error) {
                console.error('Error loading jobs for selector:', error);
                // Don't show error for selector, just leave it empty
                if (error.message && error.message.includes('Recruiter profile not found')) {
                    selector.innerHTML = '<option value="">Ch∆∞a c√≥ h·ªì s∆° nh√† tuy·ªÉn d·ª•ng</option>';
                }
            }
        }

        // Show recruiter profile required message
        function showRecruiterProfileRequired() {
            const dashboardTab = document.getElementById('dashboard');
            if (dashboardTab) {
                const existingMsg = dashboardTab.querySelector('.recruiter-profile-required');
                if (existingMsg) return; // Already shown
                
                const msg = document.createElement('div');
                msg.className = 'recruiter-profile-required bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center mb-6';
                msg.innerHTML = `
                    <i class="fas fa-exclamation-triangle text-yellow-600 text-3xl mb-3"></i>
                    <h3 class="text-lg font-semibold text-yellow-800 mb-2">Ch∆∞a c√≥ h·ªì s∆° nh√† tuy·ªÉn d·ª•ng</h3>
                    <p class="text-sm text-yellow-700 mb-4">B·∫°n c·∫ßn t·∫°o h·ªì s∆° nh√† tuy·ªÉn d·ª•ng tr∆∞·ªõc khi s·ª≠ d·ª•ng c√°c ch·ª©c nƒÉng n√†y.</p>
                    <a href="recruiter-profile.html" class="inline-block px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition">
                        <i class="fas fa-user-plus mr-2"></i>T·∫°o h·ªì s∆° ngay
                    </a>
                `;
                dashboardTab.insertBefore(msg, dashboardTab.firstChild);
            }
        }

        // Make remaining functions globally accessible
        // showTab is already exported above
        window.handlePostJob = handlePostJob;
        window.saveDraft = saveDraft;
        window.viewJobApplicants = viewJobApplicants;
        window.viewJobDetail = viewJobDetail;
        window.viewCV = viewCV;
        window.viewApplication = viewApplication;
        window.editJob = editJob;
        window.updateApplicationStatus = updateApplicationStatus;
        window.scheduleInterview = scheduleInterview;
        window.findMatchingCandidates = findMatchingCandidates;
        window.inviteCandidate = inviteCandidate;
        window.handleChatKeyPress = handleChatKeyPress;
        window.sendMessage = sendMessage;
        window.sendQuickMessage = sendQuickMessage;
        window.logout = function() {
            if (window.api) {
                window.api.logout();
            }
            window.location.href = 'login.html';
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Wait a bit to ensure all elements are ready
                setTimeout(() => {
                    // Initialize tab from URL hash
                    initializeTab();
                    
                    // Listen for hash changes
                    window.addEventListener('hashchange', handleHashChange);
                    
                    // Load initial data
                    const currentTab = window.location.hash.substring(1) || 'dashboard';
                    if (currentTab === 'dashboard') {
                        loadDashboardStats();
                    }
                    if (currentTab === 'post-job' || currentTab === 'dashboard') {
                        loadMyJobs();
                        // Check company when on post-job tab
                        if (currentTab === 'post-job') {
                            checkCompanyExists();
                        }
                    }
                    if (currentTab === 'applicants') {
                        loadFirstJobApplicants();
                    }
                    if (currentTab === 'job-matching') {
                        updateMatchingJobSelector();
                    }
                }, 100);
                
                // Attach form submit handler
                const postJobForm = document.getElementById('postJobForm');
                if (postJobForm) {
                    postJobForm.addEventListener('submit', handlePostJob);
                }
                
                // Update matching selector when switching to matching tab
                const matchingTab = document.querySelector('a[href="#job-matching"]');
                if (matchingTab) {
                    matchingTab.addEventListener('click', () => {
                        setTimeout(updateMatchingJobSelector, 100);
                    });
                }

                // User menu dropdown toggle
                const userMenuBtn = document.getElementById('userMenuBtn');
                const userMenuDropdown = document.getElementById('userMenuDropdown');
                
                if (userMenuBtn && userMenuDropdown) {
                    userMenuBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        userMenuDropdown.classList.toggle('hidden');
                    });
                    
                    // Close dropdown when clicking outside
                    document.addEventListener('click', (e) => {
                        const container = document.getElementById('userMenuContainer');
                        if (container && !container.contains(e.target)) {
                            userMenuDropdown.classList.add('hidden');
                        }
                    });
                }

                // Chat toggle
                const chatToggle = document.getElementById('chatToggle');
                const chatWindow = document.getElementById('chatWindow');
                const chatClose = document.getElementById('chatClose');
                
                if (chatToggle && chatWindow) {
                    chatToggle.addEventListener('click', () => {
                        chatWindow.classList.toggle('active');
                    });
                }
                
                if (chatClose && chatWindow) {
                    chatClose.addEventListener('click', () => {
                        chatWindow.classList.remove('active');
                    });
                }
            } catch (error) {
                console.error('Error initializing page:', error);
                // Fallback: show dashboard
                const dashboardTab = document.getElementById('dashboard');
                if (dashboardTab) {
                    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
                    dashboardTab.classList.add('active');
                }
            }
        });

        // T·∫•t c·∫£ c√°c h√†m AI ƒë√£ ƒë∆∞·ª£c chuy·ªÉn sang chat-ai.js
    </script>
</body>
</html>